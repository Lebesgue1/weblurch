(function(){var resizeHistoryHeight;window.testAppSetup=function(){var t,e,n,o,i;for(window.LE=new LurchEditor(document.getElementById("editor")),initializeHistory(),window.maindiv=LE.getElement(),$(runButton).on("click",runButtonClicked),$(resetButton).on("click",resetButtonClicked),$(downloadButton).on("click",downloadButtonClicked),$(undoButton).on("click",undoButtonClicked),$(runFullHistoryButton).on("click",runFullHistoryButtonClicked),$(codeInput).on("keyup",function(t){return 13===t.keyCode?runButtonClicked():void 0}),$(sourceTab).on("click",updateSourceTab),$(historyTab).on("click",updateHistoryTab),e=Object.keys(allTestHistories),e.sort(),e.unshift("Compare to a saved history..."),o=0,i=e.length;i>o;o++)t=e[o],n=document.createElement("option"),n.textContent=t,savedHistoriesList.appendChild(n);return $(savedHistoriesList).change(chosenHistoryChanged),resizeHistoryHeight(),$(window).resize(resizeHistoryHeight),updateView(),codeInput.focus()},window.updateView=function(){return $(sourceView).hasClass("active")&&updateSourceTab(),$(historyView).hasClass("active")?updateHistoryTab():void 0},window.updateSourceTab=function(){var t;return t=LE.getElement().outerHTML.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;"),sourceView.innerHTML="<pre>"+t+"</pre>"},window.runCodeInModel=function(code){return eval(code),testHistory.push({code:code,state:LE.getElement().toJSON()})},window.runButtonClicked=function(){return runCodeInModel(codeInput.value),updateView(),codeInput.value="",codeInput.focus()},window.runSavedStep=function(t){var e,n;return e=null!=(n=window.comparisonHistory)?n.data:void 0,e&&t<e.length?(runCodeInModel(e[t].code),updateView()):void 0},window.runFullHistoryButtonClicked=function(){var t,e,n,o,i,r;if(t=null!=(i=window.comparisonHistory)?i.data:void 0){for(r=t.slice(1),n=0,o=r.length;o>n;n++)e=r[n],runCodeInModel(e.code);return updateView()}},window.yesButtonClicked=function(t){return testHistory[t].correct===!0?delete testHistory[t].correct:testHistory[t].correct=!0,updateView()},window.noButtonClicked=function(t){return testHistory[t].correct===!1?delete testHistory[t].correct:testHistory[t].correct=!1,updateView()},window.downloadButtonClicked=function(){var t,e,n;return e=JSON.stringify(testHistory),t=new Blob([e],{type:"application/json"}),n=document.createElement("a"),n.setAttribute("href",URL.createObjectURL(t)),n.setAttribute("download",""+(testNameInput.value||"test-history")+".json"),n.click()},window.resetButtonClicked=function(){var t,e;return e=Node.fromJSON(testHistory[0].state),t=window.LE.getElement(),t.parentNode.replaceChild(e,t),window.LE=new LurchEditor(e),window.maindiv=e,initializeHistory(),chosenHistoryChanged(),updateView()},window.undoButtonClicked=function(){var t,e,n,o,i;for(t=testHistory,resetButtonClicked(),i=t.slice(1,-1),n=0,o=i.length;o>n;n++)e=i[n],runCodeInModel(e.code);return updateView()},window.chosenHistoryChanged=function(){var t;return t=$(savedHistoriesList).val(),window.comparisonHistory=t in allTestHistories?{filename:t,data:allTestHistories[t]}:null,updateView()},window.historyCommandRepresentation=function(t,e,n){var o;return null==n&&(n=""),o=t.code.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;"),"<div class='panel panel-info'>\n  <div class='panel-heading'>\n    "+n+"\n    <h3 class='panel-title'>Command "+e+":</h3>\n  </div>\n  <div class='panel-body'>\n    <pre>"+o+"</pre>\n  </div>\n</div>"},window.historyStateRepresentation=function(t,e,n,o){var i,r,s,a;return null==n&&(n=""),null==o&&(o="default"),i=Node.fromJSON(t.state).outerHTML,r=i.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;"),i=i.replace(/\s+id=['"][^'"]+['"]/g,""),s="<pre class='gap-below-2'>"+r+"</pre>\n"+i,0===e?(a="Initial state:",o+=" gap-before-2"):a="State after command "+e+":","<div class='panel panel-"+o+"'>\n  <div class='panel-heading'>\n    "+n+"\n    <h3 class='panel-title'>"+a+"</h3>\n  </div>\n  <div class='panel-body'>"+s+"</div>\n</div>"},window.updateHistoryTab=function(){var t,e,n,o,i,r,s,a,l,c,d,u,p,w,y,g,h,v,H,f,m,b,C;for(l=function(t){return"<button type='button'\n        class='btn btn-xs btn-default pull-right'\n        data-toggle='tooltip' title='Run'\n        onclick='runSavedStep("+t+");'\n ><span class='glyphicon glyphicon-play'>\n        </span></button>"},c=function(t){return"<button type='button'\n        class='btn btn-xs btn-danger pull-right'\n        data-toggle='tooltip' title='Mark incorrect'\n        onclick='noButtonClicked("+t+");'\n ><span class='glyphicon glyphicon-thumbs-down'>\n        </span></button>\n<button type='button'\n        class='btn btn-xs btn-success pull-right'\n        data-toggle='tooltip' title='Mark correct'\n        onclick='yesButtonClicked("+t+");'\n ><span class='glyphicon glyphicon-thumbs-up'>\n        </span></button>"},p="<div class='pull-right'>SAME\n    <span class='glyphicon glyphicon-ok'></span>\n</div>",i="<div class='pull-right'>DIFFERENT\n    <span class='glyphicon glyphicon-remove'></span>\n</div>",a=function(t,e){return"<div class='row'>\n    <div class='col-md-6'>"+t+"</div>\n    <div class='col-md-6'>"+e+"</div>\n</div>"},d="",e=(null!=(m=window.comparisonHistory)?m.data:void 0)||null,r=v=0,f=testHistory.length;f>v;r=++v)g=testHistory[r],r>0&&(n=historyCommandRepresentation(g,r),e&&(w=r<e.length?historyCommandRepresentation(e[r],r,l(r)):"",n=a(n,w)),d+=n),h=g.hasOwnProperty("correct")?g.correct?"success":"danger":"default",n=historyStateRepresentation(g,r,c(r),h),e&&(r<e.length?(s=JSON.stringify(g.state),u=JSON.stringify(e[r].state),s===u?(o=p,h="success"):(o=i,h="danger"),w=historyStateRepresentation(e[r],r,o,h)):w="",n=a(n,w)),d+=n;if(e&&testHistory.length<e.length)for(r=H=b=testHistory.length,C=e.length;C>=b?C>H:H>C;r=C>=b?++H:--H)g=e[r],t=historyCommandRepresentation(g,r,l(r)),y=historyStateRepresentation(e[r],r,"","default"),d+=a("",t),d+=a("",y);return historyBody.innerHTML=d},resizeHistoryHeight=function(){var t,e,n,o,i;for(e=75,i=Array.prototype.slice.apply(mainContainer.childNodes),n=0,o=i.length;o>n;n++)t=i[n],t instanceof HTMLElement&&!$(t).hasClass("tab-content")&&(e+=$(t).outerHeight(!0));return $(historyBody).height($(window).height()-e)},window.initializeHistory=function(){return window.testHistory=[{code:"",state:LE.getElement().toJSON()}],window.comparisonHistory=null}}).call(this);
//# sourceMappingURL=testapp.min.js.map
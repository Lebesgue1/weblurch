(function(){var e,n,t,i,o,a,r={}.hasOwnProperty,l=[].indexOf||function(e){for(var n=0,t=this.length;t>n;n++)if(n in this&&this[n]===e)return n;return-1};a={},window.setTagData=function(e){return a=e},window.addTagData=function(e){var n,t,i;i=[];for(n in e)r.call(e,n)&&(t=e[n],i.push(a[n]=t));return i},window.pluginsToLoad=["dialogs"],window.setGroupTag=function(e,n){return e.set("tagName",n)},window.getGroupTag=function(e){return e.get("tagName")},window.initializeGroupTag=function(e){var n,t;return n=e.parent?window.getGroupTag(e.parent):window.topLevelTagName(),t=window.getTagData(n,"defaultChild"),t?window.setGroupTag(e,t):void 0},window.getTagData=function(e,n){var t;return e instanceof window.Group&&(e=window.getGroupTag(e)),null!=(t=a[e])?t[n]:void 0},window.getTagExternalName=function(e){var n;return e instanceof window.Group&&(e=window.getGroupTag(e)),null!=(n=window.getTagData(e,"externalName"))?n:e},window.topLevelTagName=function(){var e,n;for(e in a)if(r.call(a,e)&&(n=a[e],n.topLevel))return e},window.XMLMenuItems=function(e){var n,t,i,o,r,l,u;return r=[],null!=(l=window.getGroupTag(e))&&(i=window.getTagExternalName(l),null!=(t=window.getTagData(l,"documentation"))&&(t=t.replace(/a href=/g,'a target="_blank" href='),r.push({text:'Read "'+i+'" documentation',onclick:function(){return tinymce.activeEditor.Dialogs.alert({title:'Documentation for "'+i+'"',message:t})}}))),r.push({text:"View XML representation",onclick:function(){var n;return n=window.convertToXML(e).replace(/&/g,"&amp;").replace(/</g,"&lt;"),tinymce.activeEditor.Dialogs.alert({title:"XML Representation",message:"<pre>"+n+"</pre>"})}}),o=e.parent?window.getGroupTag(e.parent):window.topLevelTagName(),n=window.getTagData(o,"allowedChildren"),r.push({text:"Change tag to...",menu:function(){var t,i,o,r;for(o=Object.keys(a).sort(),r=[],t=0,i=o.length;i>t;t++)u=o[t],r.push(function(t){return{text:window.getTagExternalName(t),disabled:null!=n&&!(t in n),onclick:function(){return e.set("tagName",t)}}}(u));return r}()}),r},window.groupToolbarButtons={viewxml:{text:"XML",tooltip:"View XML representation of this document",onclick:function(){var t,i,o,a,r,l,u,c;for(r=[],o=tinymce.activeEditor,c=o.Groups.ids(),l=0,u=c.length;u>l;l++)if(a=c[l],!n(o.Groups[a])){r.push("At least one element in your document has errors (indicated by a red X following the element).");break}return t=window.getTagData(window.topLevelTagName(),"allowedChildren"),t&&(r=r.concat(e(o.Groups.topLevel,t,"document"))),i=function(){var e;return e=encodeURIComponent(window.convertToXML()),window.open("data:application/xml,"+e,"_blank")},0===r.length?i():tinymce.activeEditor.Dialogs.confirm({title:"Problems with your document",message:"<p><b>The problems listed below exist in your document.</b></p> <ul><li>"+r.join("</li><li>")+"</li></ul> <p>You can click OK to generate XML anyway, but it may be invalid.  Click Cancel to go back and fix these problems first.</b></p>",okCallback:i})}}},window.XMLGroupChanged=function(e,n){return n&&!e.get("tagName")&&setTimeout(function(){return window.initializeGroupTag(e)},0),window.validateHierarchy(e)},window.XMLGroupDeleted=function(e){var n;if(null!=e.parent){if(e.parent.children[0])return window.validateHierarchy(e.parent.children[0])}else if(null!=(n=e.plugin)?n.topLevel[0]:void 0)return window.validateHierarchy(e.plugin.topLevel[0])},t=function(e){return e.set("valid",!0),e.clear("closeDecoration"),e.clear("closeHoverText")},i=function(e,n){return e.set("valid",!1),e.set("closeDecoration",'<font color="red">&#10006;</font>'),e.set("closeHoverText",n)},n=function(e){return e.get("valid")},window.validateHierarchy=function(n){var o,a,r,u,c,d,g,w,s,p,f,h,m,v,T,y;if(T=[],!n.children)return void setTimeout(function(){return window.validateHierarchy(n)},100);if(null==(w=window.getGroupTag(n))&&T.push("Each element must have a tag, but this one does not.  Add a tag using the context menu."),f=n.parent?window.getGroupTag(n.parent):window.topLevelTagName(),u=window.getTagData(n,"belongsIn"),"string"==typeof u&&(u=[u]),u instanceof Array&&l.call(u,f)<0&&(g=window.getTagExternalName(n),m=window.getTagExternalName(f),c=function(){var e,n,t;for(t=[],e=0,n=u.length;n>e;e++)a=u[e],t.push(window.getTagExternalName(a));return t}(),m=m?""+m+" elements":"in an element without a tag",c=function(){var e,n,t;for(t=[],e=0,n=u.length;n>e;e++)a=u[e],t.push(window.getTagExternalName(a));return t}(),h=function(){switch(c.length){case 1:return"this kind of element: "+c[0];case 2:return"these kinds of elements: "+c.join(" and ");default:return"these kinds of elements: "+c.join(", ")}}(),T.push(""+g+" elements are only permitted in "+h+" (not "+m+").")),v=n.previousSibling()?window.getGroupTag(n.previousSibling()):null,r=window.getTagData(n,"belongsAfter"),"string"==typeof u&&(r=[r]),null===r&&(r=[null]),r instanceof Array&&l.call(r,v)<0&&(g=window.getTagExternalName(n),m=window.getTagExternalName(v),m=m?""+m+" elements":"being first in their context",c=function(){var e,n,t,i;for(i=[],e=0,n=r.length;n>e;e++)a=r[e],i.push(null!=(t=window.getTagExternalName(a))?t:"none (i.e., being the first in their context)");return i}(),h=function(){switch(c.length){case 1:return"this kind of element: "+c[0];case 2:return"these kinds of elements: "+c.join(" and ");default:return"these kinds of elements: "+c.join(", ")}}(),T.push(""+g+" elements are only permitted to follow "+h+" (not "+m+").")),window.getTagData(n,"unique"))for(y=n;y=y.previousSibling();)if(window.getGroupTag(y)===w){T.push('Each context may contain only one "'+window.getTagExternalName(n)+'" element.  But there is already an earlier one in this context, making this one invalid.');break}return(o=window.getTagData(n,"allowedChildren"))&&(T=T.concat(e(n.children,o))),(d=window.getTagData(n,"contentCheck"))&&(s=d(n),s instanceof Array&&(T=T.concat(s))),T.length>0?i(n,T.join("\n")):t(n),(p=n.nextSibling())?window.validateHierarchy(p):void 0},e=function(e,n,t){var i,o,a,l,u,c,d,g,w,s,p,f,h,m;for(null==t&&(t="element"),g=[],l={},f=0,h=e.length;h>f;f++)i=e[f],o=window.getGroupTag(i),null==l[o]&&(l[o]=0),l[o]++;for(w in n)r.call(n,w)&&null==l[w]&&(l[w]=0);for(w in l)r.call(l,w)&&(a=l[w],n.hasOwnProperty(w)&&(m=n[w],d=m[0],c=m[1],null!=d&&null!=c&&"number"==typeof d&&"number"==typeof c&&(s=1===a?"is":"are",p=1===d?"child":"children",u=window.getTagExternalName(w),d>a&&g.push("The "+t+" requires at least "+d+" "+p+" with tag "+u+", but there "+s+" "+a+" in this "+t+"."),p=1===c?"child":"children",a>c&&g.push("The "+t+" permits at most "+c+" "+p+" with tag "+u+", but there "+s+" "+a+" in this "+t+"."))));return g},window.convertToXML=function(e){var n,t,i,r,l,u,c,d,g,w,s;return null!=e?(i=e.children,d=window.getGroupTag(e)):(i=tinymce.activeEditor.Groups.topLevel,d=window.topLevelTagName()),s=window.getTagData(d,"includeText"),w=function(e){var n,t;return s?a.hasOwnProperty(s)?(t="<"+s+">"+e+"</"+s+">",(n=window.getTagData(s,"alterXML"))&&(t=n(t)),t):e:""},c=function(){var n,a;if(i.length){for(r=function(e){return"  "+e.replace(RegExp("\n","g"),"\n  ")},u=i[0].rangeBefore(),l="",/^\s*$/.test(u.toString())||(l+=w(tinymce.DOM.encode(o(u)))),n=0,a=i.length;a>n;n++)t=i[n],"\n"!==l[l.length-1]&&(l+="\n"),l+=""+window.convertToXML(t)+"\n",u=t.rangeAfter(),/^\s*$/.test(u.toString())||(l+=w(tinymce.DOM.encode(o(u))));return"<"+d+">\n"+r(l)+"\n</"+d+">"}return g=window.getTagData(d,"rawXML")?(null!=e?e.contentAsText():tinymce.activeEditor.getContent({format:"text"})).replace(/\xA0/g,"\n"):tinymce.DOM.encode(null!=e?e.contentAsHTML():tinymce.activeEditor.getContent()),null==s&&(s=!0),"<"+d+">"+w(g)+"</"+d+">"}(),(n=window.getTagData(d,"alterXML"))&&(c=n(c,e)),c},o=function(e){var n,t,i,o,a,r;return(n=null!=e?e.cloneContents():void 0)?(o=e.startContainer.ownerDocument.createElement("div"),o.appendChild(n),t=o.innerHTML,r=/^\s/.test(t)?" ":"",a=/\s+$/.test(t)?" ":"",i=tinymce.activeEditor.serializer.serialize(o,{get:!0,format:"html",selection:!0,getInner:!0}),r+i+a):null}}).call(this);
//# sourceMappingURL=xml-groups-solo.min.js.map
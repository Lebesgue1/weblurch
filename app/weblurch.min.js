(function(){var t,e={}.hasOwnProperty,n=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};Node.prototype.address=function(t){var e;return null==t&&(t=null),this===t?[]:this.parentNode?(e=this.parentNode.address(t),null===e?null:e.concat([Array.prototype.slice.apply(this.parentNode.childNodes).indexOf(this)])):t?null:[]},Node.prototype.index=function(t){var e;if(!(t instanceof Array))throw Error("Node address function requires an array");return 0===t.length?this:"number"!=typeof t[0]?void 0:null!=(e=this.childNodes[t[0]])?e.index(t.slice(1)):void 0},Node.prototype.toJSON=function(t){var e,n,r,i,o,s;if(null==t&&(t=!0),this instanceof Text)return this.textContent;if(this instanceof Comment)return t?{comment:!0,content:this.textContent}:{m:!0,n:this.textContent};if(!(this instanceof Element))throw Error("Cannot serialize this node: "+this);if(r={tagName:this.tagName},this.attributes.length)for(r.attributes={},s=this.attributes,i=0,o=s.length;o>i;i++)e=s[i],r.attributes[e.name]=e.value;return this.childNodes.length&&(r.children=function(){var e,r,i,o;for(i=this.childNodes,o=[],e=0,r=i.length;r>e;e++)n=i[e],o.push(n.toJSON(t));return o}.call(this)),t||(r.t=r.tagName,delete r.tagName,r.a=r.attributes,delete r.attributes,r.c=r.children,delete r.children),r},Node.fromJSON=function(t){var n,r,i,o,s,d,a,h;if("string"==typeof t)return document.createTextNode(t);if("comment"in t&&t.comment)return document.createComment(t.content);if("m"in t&&t.m)return document.createComment(t.n);if(!1 in t&&!1 in t)throw Error("Object has no t[agName]: "+this);if(s=document.createElement(t.tagName||t.t),n=t.attributes||t.a)for(o in n)e.call(n,o)&&(d=n[o],s.setAttribute(o,d));if(i=t.children||t.c)for(a=0,h=i.length;h>a;a++)r=i[a],s.appendChild(Node.fromJSON(r));return s},window.LurchEditor=t=function(){function t(t){var e,r;if(this.element=null,t&&"DIV"!==(null!=t?t.tagName:void 0))throw new Error("LurchEditor can only be\nconstructed in a DIV node");r=this.cleanIds(t),this.freeIds=0===r.length?[0]:function(){var t,i,o;for(o=[],e=t=0,i=Math.max.apply(Math,r)+1;i>=0?i>=t:t>=i;e=i>=0?++t:--t)n.call(r,e)<0&&o.push(e);return o}(),this.assignIds(t),this.element=t}return t.prototype.nextFreeId=function(){return this.freeIds.length>1?this.freeIds.shift():this.freeIds[0]++},t.prototype.addFreeId=function(t){return t<this.freeIds[this.freeIds.length-1]?(this.freeIds.push(t),this.freeIds.sort(function(t,e){return t-e})):void 0},t.prototype.cleanIds=function(t){var e,r,i,o,s,d;if(i=[],!(t instanceof Node))return i;for(t.id&&(/^\d+$/.test(t.id)?i.push(parseInt(t.id)):t.removeAttribute("id")),d=t.childNodes,o=0,s=d.length;s>o;o++)e=d[o],i=i.concat(function(){var t,o,s,d;for(s=this.cleanIds(e),d=[],t=0,o=s.length;o>t;t++)r=s[t],n.call(i,r)<0&&d.push(r);return d}.call(this));return i},t.prototype.assignIds=function(t){var e,n,r,i,o;if(t instanceof Node){for(t instanceof HTMLElement&&!t.id&&(t.id=this.nextFreeId()),i=t.childNodes,o=[],n=0,r=i.length;r>n;n++)e=i[n],o.push(this.assignIds(e));return o}},t.prototype.getElement=function(){return this.element},t.prototype.address=function(t){return this.element?null!=t?t.address(this.element):void 0:null},t.prototype.index=function(t){return this.element?this.element.index(t):null},t}()}).call(this);
//# sourceMappingURL=weblurch.min.js.map
(function(){var t,e,n={}.hasOwnProperty,r=function(t,e){function r(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},i=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};window.DOMEditTracker=t=function(){function t(t){if(this.element=null,t&&"DIV"!==(null!=t?t.tagName:void 0))throw new Error("DOMEditTracker can only be constructed in a DIV node");this.element=t}return t.prototype.getElement=function(){return this.element},t}(),Node.prototype.address=function(t){var e;return null==t&&(t=null),this===t?[]:this.parentNode?(e=this.parentNode.address(t),null===e?null:e.concat([Array.prototype.slice.apply(this.parentNode.childNodes).indexOf(this)])):t?null:[]},Node.prototype.index=function(t){var e;if(!(t instanceof Array))throw Error("Node address function requires an array");return 0===t.length?this:"number"!=typeof t[0]?void 0:null!=(e=this.childNodes[t[0]])?e.index(t.slice(1)):void 0},Node.prototype.toJSON=function(t){var e,n,r,i,o,s;if(null==t&&(t=!0),this instanceof Text)return this.textContent;if(this instanceof Comment)return t?{comment:!0,content:this.textContent}:{m:!0,n:this.textContent};if(!(this instanceof Element))throw Error("Cannot serialize this node: "+this);if(r={tagName:this.tagName},this.attributes.length)for(r.attributes={},s=this.attributes,i=0,o=s.length;o>i;i++)e=s[i],r.attributes[e.name]=e.value;return this.childNodes.length&&(r.children=function(){var e,r,i,o;for(i=this.childNodes,o=[],e=0,r=i.length;r>e;e++)n=i[e],o.push(n.toJSON(t));return o}.call(this)),t||(r.t=r.tagName,delete r.tagName,r.a=r.attributes,delete r.attributes,r.c=r.children,delete r.children),r},Node.fromJSON=function(t){var e,r,i,o,s,a,d,u;if("string"==typeof t)return document.createTextNode(t);if("comment"in t&&t.comment)return document.createComment(t.content);if("m"in t&&t.m)return document.createComment(t.n);if(!1 in t&&!1 in t)throw Error("Object has no t[agName]: "+this);if(s=document.createElement(t.tagName||t.t),e=t.attributes||t.a)for(o in e)n.call(e,o)&&(a=e[o],s.setAttribute(o,a));if(i=t.children||t.c)for(d=0,u=i.length;u>d;d++)r=i[d],s.appendChild(Node.fromJSON(r));return s},window.LurchEditor=e=function(t){function e(t){var n,r;e.__super__.constructor.call(this,t),r=this.cleanIds(t),this.freeIds=0===r.length?[0]:function(){var t,e,o;for(o=[],n=t=0,e=Math.max.apply(Math,r)+1;e>=0?e>=t:t>=e;n=e>=0?++t:--t)i.call(r,n)<0&&o.push(n);return o}(),this.assignIds(t)}return r(e,t),e.prototype.nextFreeId=function(){return this.freeIds.length>1?this.freeIds.shift():this.freeIds[0]++},e.prototype.addFreeId=function(t){return t<this.freeIds[this.freeIds.length-1]?(this.freeIds.push(t),this.freeIds.sort(function(t,e){return t-e})):void 0},e.prototype.cleanIds=function(t){var e,n,r,o,s,a;if(r=[],!(t instanceof Node))return r;for(t.id&&(/^\d+$/.test(t.id)?r.push(parseInt(t.id)):t.removeAttribute("id")),a=t.childNodes,o=0,s=a.length;s>o;o++)e=a[o],r=r.concat(function(){var t,o,s,a;for(s=this.cleanIds(e),a=[],t=0,o=s.length;o>t;t++)n=s[t],i.call(r,n)<0&&a.push(n);return a}.call(this));return r},e.prototype.assignIds=function(t){var e,n,r,i,o;if(t instanceof Node){for(t instanceof HTMLElement&&!t.id&&(t.id=this.nextFreeId()),i=t.childNodes,o=[],n=0,r=i.length;r>n;n++)e=i[n],o.push(this.assignIds(e));return o}},e.prototype.address=function(t){return this.element?null!=t?t.address(this.element):void 0:null},e.prototype.index=function(t){return this.element?this.element.index(t):null},e}(t)}).call(this);
//# sourceMappingURL=weblurch.min.js.map
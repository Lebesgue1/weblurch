(function(){var t,e,i;setAppName("Lurch"),window.menuBarIcon={src:"icons/apple-touch-icon-76x76.png",width:"26px",height:"26px",padding:"2px"},window.groupTypes=[{name:"me",text:"Meaningful expression",imageHTML:'<font color="#996666">[]</font>',openImageHTML:'<font color="#996666">[</font>',closeImageHTML:'<font color="#996666">]</font>',tooltip:"Make text a meaningful expression",color:"#996666"}],window.pluginsToLoad=["mediawiki","settings","dialogs"],e=function(t,e){var i;return null==e&&(e={}),i=encodeURIComponent(JSON.stringify(e)),"<span id='metadata' style='display: none;' >"+i+"</span>"+t},i=function(t){var e,i;return i=/^<span[^>]+id=.metadata.[^>]*>([^<]*)<\/span>/,(e=i.exec(t))?{metadata:JSON.parse(decodeURIComponent(e[1])),document:t.slice(e[0].length)}:{metadata:null,document:t}},window.groupMenuItems={file_order:"sharelink wikiimport wikiexport | appsettings docsettings",sharelink:{text:"Share document...",context:"file",onclick:function(){var t,e,i;return t=window.location.href.split("?")[0],i=t+"?document="+encodeURIComponent(tinymce.activeEditor.getContent()),e=gapi.client.urlshortener.url.insert({resource:{longUrl:i}}),e.execute(function(t){return null!=t.id?i=t.id:console.log("Error creating short URL",t),prompt("Copy the following URL to your clipboard, and paste it wherever you like, such as an email message.",i)})}},wikiimport:{text:"Import from wiki...",context:"file",onclick:function(){var e;if(!t()&&(e=prompt("Give the name of the page to import (case sensitive)","Main Page"),null!==e))return tinymce.activeEditor.MediaWiki.getPageContent(e,function(t,e){var n,o,a;return e?(tinymce.activeEditor.Dialogs.alert({title:"Wiki Error",message:"<p>Error loading content from wiki:</p> <p>"+e.split("\n")[0]+"</p>"}),void console.log(e)):(a=i(t),o=a.metadata,n=a.document,null==o?void tinymce.activeEditor.Dialogs.alert({title:"Not a Lurch document",message:"<p><b>The wiki page that you attempted to import is not a Lurch document.</b></p> <p>Although it is possible to import any wiki page into Lurch, it does not work well to edit and re-post such pages to the wiki.</p> <p>To edit a non-Lurch wiki page, visit the page on the wiki and edit it there.</p>"}):(tinymce.activeEditor.setContent(n),tinymce.activeEditor.Settings.document.metadata=o))})}},wikiexport:{text:"Export to wiki",context:"file",onclick:function(){var i,n,o,a,r;if(!t())return n=tinymce.activeEditor.Settings.document.get("wiki_title"),null==n?void tinymce.activeEditor.Dialogs.alert({title:"Page Title not set",message:"<p>You have not yet set the title under which this document should be published on the wiki.  See the document settings on the File menu.</p>"}):(r=tinymce.activeEditor.Settings.application.get("wiki_username"),o=tinymce.activeEditor.Settings.application.get("wiki_password"),null==r||null==o?void tinymce.activeEditor.Dialogs.alert({title:"No Wiki Credentials",message:"<p>You have not given your wiki username and password to the application settings.  See the application settings on the File menu.</p>"}):(a=function(t,e){var i,o;return e?void tinymce.activeEditor.Dialogs.alert({title:"Posting Error",message:"<p>Error when posting to the wiki:</p> <p>"+e+"</p>"}):(i=/^[^/]+\/\/[^/]+\//.exec(window.location.href),o=window.location.href.slice(0,i[0].length)+"wiki/index.php?title="+encodeURIComponent(n),tinymce.activeEditor.Dialogs.alert({title:"Document Posted",message:"<p>Posting succeeded.</p> <p><a href='"+o+"' target='_blank'>Visit posted page.</a></p>"}))},i=function(t,i){var o;return i?void tinymce.activeEditor.Dialogs.alert({title:"Wiki Login Error",message:"<p>Error when logging into the wiki:</p> <p>"+i+"</p>"}):(o=tinymce.activeEditor.getContent(),o=e(o,tinymce.activeEditor.Settings.document.metadata),tinymce.activeEditor.MediaWiki.exportPage(n,o,a))},tinymce.activeEditor.MediaWiki.login(r,o,i)))}},appsettings:{text:"Application settings...",context:"file",onclick:function(){return tinymce.activeEditor.Settings.application.showUI()}},docsettings:{text:"Document properties...",context:"file",onclick:function(){return tinymce.activeEditor.Settings.document.showUI()}}},window.addEventListener("load",function(){return gapi.client.setApiKey("AIzaSyAf7F0I39DdI2jtD7zrPUa4eQvUXZ-K6W8"),gapi.client.load("urlshortener","v1",function(){})},!1),window.afterEditorReady=function(t){var e,i,n,o;return e=t.Settings.addCategory("application"),e.setup=function(i){var n,o;return i.innerHTML=[t.Settings.UI.heading("Wiki Login"),t.Settings.UI.info('Entering a username and password here does NOT create an account on the wiki.  You must already have one.  If you do not, first visit <a href="/wiki/index.php" target="_blank" style="color: blue;">the wiki</a>, create an account, then return here.'),t.Settings.UI.text("Username","wiki_username",null!=(n=e.get("wiki_username"))?n:""),t.Settings.UI.password("Password","wiki_password",null!=(o=e.get("wiki_password"))?o:"")].join("\n")},e.teardown=function(t){var i;return i=function(e){return t.ownerDocument.getElementById(e)},e.set("wiki_username",i("wiki_username").value),e.set("wiki_password",i("wiki_password").value)},i=t.Settings.addCategory("document"),i.metadata={},i.get=function(t){return i.metadata[t]},i.set=function(t,e){return i.metadata[t]=e},i.setup=function(e){var n;return e.innerHTML=[t.Settings.UI.heading("Wiki Publishing"),t.Settings.UI.text("Publish to wiki under this title","wiki_title",null!=(n=i.get("wiki_title"))?n:"")].join("\n")},i.teardown=function(t){var e;return e=function(e){return t.ownerDocument.getElementById(e)},i.set("wiki_title",e("wiki_title").value)},t.LoadSave.saveMetaData=function(){return i.metadata},t.LoadSave.loadMetaData=function(t){return i.metadata=t},t.MediaWiki.setIndexPage("/wiki/index.php"),t.MediaWiki.setAPIPage("/wiki/api.php"),(n=/\?wikipage=(.*)/.exec(window.location.search))&&t.MediaWiki.importPage(decodeURIComponent(n[1])),(o=localStorage.getItem("auto-load"))&&setTimeout(function(){return localStorage.removeItem("auto-load"),tinymce.activeEditor.setContent(o)},100),(n=/\?document=(.*)/.exec(window.location.search))?(localStorage.setItem("auto-load",decodeURIComponent(n[1])),window.location.href=window.location.href.split("?")[0]):void 0},t=function(){var t;return t=/nathancarter\.github\.io/.test(window.location.href),t&&tinymce.activeEditor.Dialogs.alert({title:"Not Available Here",message:"<p>That functionality requires MediaWiki to be running on the server from which you're accessing this web app.</p> <p>On GitHub, we cannot run a MediaWiki server, so the functionality is disabled.</p> <p>The menu items remain for use in developer testing, as we prepare for a dedicated server that will have MediaWiki and the ability to publish documents to that wiki with a single click, or edit them in Lurch with a single click.</p> <p>Try back soon!</p>"}),t}}).call(this);
//# sourceMappingURL=main-app.solo.min.js.map
(function(){var e,n,t,o,r,i,a,c,s,u,l,f,d,h,m,p,g,y,b,v,w,T,x,E,C={}.hasOwnProperty,M=[].indexOf||function(e){for(var n=0,t=this.length;t>n;n++)if(n in this&&this[n]===e)return n;return-1},N=[].slice;setAppName("LeanApp"),addHelpMenuSourceCodeLink("app/lean-example-solo.litcoffee"),h=null,m=function(){return(new Date).getTime()},v=function(){return h=m()},i=function(){return"(took "+(m()-h)+" ms)"},t=window.Module={},t.TOTAL_MEMORY=67108864,t.noExitRuntime=!0,n=null,e=null,t.print=function(t){var o;if(o=null,o=/FLYCHECK_BEGIN (.*)/.exec(t))return n={type:o[1],text:[]};if(n)return(o=/([^:]+):(\d+):(\d+): (.*)/.exec(t))?(n.file=o[1],n.line=o[2],n["char"]=o[3],n.info=o[4]):/FLYCHECK_END/.test(t)?(e.push(n),n=null):n.text.push(t);throw new Error("Unexpected output from Lean: "+t)},t.preRun=[function(){}],g=window.runLeanOn=function(n){return t.lean_init(!1),t.lean_import_module("standard"),FS.writeFile("test.lean",n,{encoding:"utf8"}),e=[],t.lean_process_file("test.lean"),e},E=!1,b=function(e,n,t){return e.set("closeDecoration",n),e.set("closeHoverText",t)},d=function(e,n,t){var o,r;return o=n?"green":"red",r=n?"&#10003;":"&#10006;",b(e,"<font color='"+o+"'>"+r+"</font>",t)},c=function(e){return e.clear("closeDecoration"),e.clear("closeHoverText")},u=function(e){return"undefined"!=typeof e.get("closeDecoration")},a=function(){var e,n,t,o,r;if(!E){for(E=!0,e=tinymce.activeEditor.Groups,r=e.ids(),t=0,o=r.length;o>t;t++)n=r[t],c(e[n]);return E=!1}},T=window.validate=function(){var e,n,t,o,r,i,a,c,f,h,m,p,y,v,w,T,x,M,N,L,R,k,I,O,H,A,G,_,j,S,$,D,F,q;if(i=tinymce.activeEditor.Groups,!E){for(E=!0,_=i.ids(),M=0,k=_.length;k>M;M++)a=_[M],"term"===i[a].typeName()&&"term"===(null!=(j=i[a].parent)?j.typeName():void 0)&&d(i[a],!1,"A term group cannot be inside another term group.");for(y={},S=(m=s()).lines,c=N=0,I=S.length;I>N;c=++N)p=S[c],(v=/[ ]--[ ](\d+)$/.exec(p))&&(y[c+1]=parseInt(v[1]));for(h=-1,n=m.lines.join("\n").replace(String.fromCharCode(160),String.fromCharCode(32)),$=g(n),L=0,O=$.length;O>L;L++)w=$[L],a=y[w.line],(f=/error:/.test(w.info))&&(h=a),r="Lean reported:\n\n"+w.info,w.text.length&&(r+="\n"+w.text.join("\n")),e=parseInt(w["char"]),e=e>0?(t=m.lines[w.line-1],"\n\ncharacter #"+(e+1)+" in this code: \n"+/^(.*) -- \d+$/.exec(t)[1]):"",d(i[a],!f,r+e);for(D=i.ids(),R=0,H=D.length;H>R&&(a=D[R],a!==h);R++)u(i[a])||d(i[a],!0,"No errors reported.");for(F=i.ids(),G=0,A=F.length;A>G;G++)if(a=F[G],"type"===(x=i[a].typeName())){if(l(i[a]))continue;T=function(){var e,n,t,r;for(t=i[a].connectionsOut(),r=[],n=0,e=t.length;e>n;n++)o=t[n],"term"===i[o[1]].typeName()&&r.push(o[1]);return r}(),0===T.length&&b(i[a],'<font color="#aaaa00"><b>&#10039;</b></font>',"This "+x+" does not modify any terms, and was thus ignored in validation.  Did you mean to connect it to a term?")}q=m.errors;for(a in q)C.call(q,a)&&(w=q[a],d(i[a],!1,w));return E=!1}},x=null,window.groupToolbarButtons.validate={text:"Run Lean",tooltip:"Run Lean on this document",onclick:function(){return x.text("Running..."),x.disabled(!0),setTimeout(function(){return T(),x.disabled(!1),x.text("Run Lean")},0)},onPostRender:function(){return x=this}},f={check:"check (TERM)",eval:"eval (TERM)",print:'print "TERM"',"import":"import TERM",open:"open TERM",constant:"constant TERM",variable:"variable TERM",definition:"definition TERM",theorem:"theorem TERM",example:"example TERM"},window.groupTypes=[{name:"term",text:"Lean Term",tooltip:"Make the selection a Lean term",color:"#666666",imageHTML:'<font color="#666666"><b>[ ]</b></font>',openImageHTML:'<font color="#666666"><b>[</b></font>',closeImageHTML:'<font color="#666666"><b>]</b></font>',contentsChanged:a,tagContents:function(e){var n;return(n=e.get("leanCommand"))?"Command: "+n:null},contextMenuItems:function(e){return[{text:"Edit command...",onclick:function(){var n,t;return n=prompt("Enter the Lean command to use on this code (or leave blank for none).\n \nValid options include:\n"+Object.keys(f).join(" "),null!=(t=e.get("leanCommand"))?t:""),null!==n?""===n?e.clear("leanCommand"):n in f?e.set("leanCommand",n):alert("That was not one of the choices.  No change has been made to your document."):void 0}}]},connectionRequest:function(e,n){var t,o;if("term"===n.typeName()||"body"===n.typeName())return o=n.id(),M.call(function(){var n,o,r,i;for(r=e.connectionsOut(),i=[],n=0,o=r.length;o>n;n++)t=r[n],i.push(t[1]);return i}(),o)>=0?e.disconnect(n):p(n.id(),e.id())?alert("That would create a cycle of arrows, which is not permitted."):e.connect(n)},connections:function(e){var n,t,o;return t=e.connectionsOut(),n=e.connectionsIn(),N.call(t).concat(N.call(n),N.call(function(){var e,n,r;for(r=[],e=0,n=t.length;n>e;e++)o=t[e],r.push(o[1]);return r}()),N.call(function(){var e,t,r;for(r=[],e=0,t=n.length;t>e;e++)o=n[e],r.push(o[0]);return r}()))}}],w=window.termGroupToCode=function(e){var n,t,r,i,a,c,s,u,l,h,m,p,g,y,b,v,T,x,E,C;if(h=tinymce.activeEditor.Groups,e.children.length>0)throw Error("Invalid structure: Term groups may not contain other groups");for(b=e.contentAsText().trim(),r=function(){var n,t,o,r;for(o=e.connectionsOut(),r=[],n=0,t=o.length;t>n;n++)u=o[n],r.push(u[1]);return r}(),t=function(){var e,t,i;for(i=[],e=0,t=r.length;t>e;e++){n=r[e];try{i.push("term"===h[n].typeName()?w(h[n]):o(h[n]))}catch(a){throw l=a,d(h[n],!1,l.message),Error("A term to which this term points (directly or indirectly) contains an error, and thus this term's meaning cannot be determined.")}}return i}(),r.length>0&&(b="( -- "+e.id()+"\n "+b+" -- "+e.id()+"\n "+t.join("\n")+"\n )"),p=[],a=[],i=[],E=e.connectionsIn(),T=0,x=E.length;x>T;T++)u=E[T],y=h[u[0]],"type"===y.typeName()?(v=y.contentAsText().trim(),M.call(a,v)<0&&a.push(v)):"body"===y.typeName()&&(C=y.id(),M.call(i,C)<0)?i.push(y.id()):"term"===y.typeName()&&p.push(y);if(a.length>1)throw Error("Invalid structure: Two different types are assigned to this term ("+a.join(", ")+")");if(i.length>1)throw Error("Invalid structure: Two bodies are assigned to this term.");if(p.length>0){if(a.length>0)throw Error("Invalid structure: A subterm of another term cannot have a type assigned.");if(i.length>0)throw Error("Invalid structure: A subterm of another term cannot have a body assigned.")}if(a.length>0&&(v=a[0],b=(m=/^\s*check\s+(.*)$/.exec(b))?"check ("+m[1]+" : "+v+")":(m=/^\s*check\s+\((.*)\)\s*$/.exec(b))?"check ("+m[1]+" : "+v+")":(m=/^(.*):=(.*)$/.exec(b))?""+m[1]+" : "+v+" := "+m[2]:""+b+" : "+v),(c=e.get("leanCommand"))&&(b=f[c].replace("TERM",b)),g=""+b+" -- "+e.id(),i.length>0){if(s=["theorem","definition","example"],M.call(s,c)<0)throw Error("Terms may only be assigned bodies if they embed one of these commands: "+s.join(", ")+".");g+="\n:= "+o(h[i[0]])}return g},s=window.documentToCode=function(){var e,n,t,o,i,a,c;for(o={lines:[],errors:{}},c=tinymce.activeEditor.Groups.topLevel,i=0,a=c.length;a>i;i++)if(n=c[i],"body"===n.typeName()&&r(n))t=y(n),o.lines=o.lines.concat(t.split("\n"));else if("term"===n.typeName()&&!l(n))try{t=w(n),o.lines=o.lines.concat(t.split("\n"))}catch(s){e=s,o.errors[n.id()]=e.message}return o},l=function(e){var n,t,o,r;for(r=e.connectionsIn(),t=0,o=r.length;o>t;t++)if(n=r[t],"term"===tinymce.activeEditor.Groups[n[0]].typeName())return!0;return!1},r=function(e){var n,t,o,r;for(r=e.connectionsOut(),t=0,o=r.length;o>t;t++)if(n=r[t],"term"===tinymce.activeEditor.Groups[n[1]].typeName())return!1;return!0},p=function(e,n){var t,o,r,i,a;for(o=tinymce.activeEditor.Groups,a=[],i=[e];i.length>0;){if((r=i.shift())===n)return!0;M.call(a,r)>=0||(a.push(r),i=i.concat(function(){var e,n,i,a;for(i=o[r].connectionsOut(),a=[],e=0,n=i.length;n>e;e++)t=i[e],a.push(t[1]);return a}()))}return!1},window.groupTypes.push({name:"type",text:"Lean Type",tooltip:"Make the selection a Lean type",color:"#66bb66",imageHTML:'<font color="#66bb66"><b>[ ]</b></font>',openImageHTML:'<font color="#66bb66"><b>[</b></font>',closeImageHTML:'<font color="#66bb66"><b>]</b></font>',contentsChanged:a,connectionRequest:function(e,n){var t,o;if("term"===n.typeName())return o=n.id(),M.call(function(){var n,o,r,i;for(r=e.connectionsOut(),i=[],n=0,o=r.length;o>n;n++)t=r[n],i.push(t[1]);return i}(),o)>=0?e.disconnect(n):e.connect(n)}}),window.useGroupConnectionsUI=!0,window.groupTypes.push({name:"body",text:"Body of a Lean definition or section",tooltip:"Make the selection a body",color:"#6666bb",imageHTML:'<font color="#6666bb"><b>[ ]</b></font>',openImageHTML:'<font color="#6666bb"><b>[</b></font>',closeImageHTML:'<font color="#6666bb"><b>]</b></font>',contentsChanged:a,contextMenuItems:function(e){var n,t;return t=function(){var n;return n=prompt("Enter the identifier to use as the name of the namespace.",e.get("namespace")),null!==n?/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(n)?e.set("namespace",n):alert("That was a valid Lean identifier.  No change has been made to your document."):void 0},r(e)?(n=e.get("namespace"))?[{text:"Make this a section",onclick:function(){return e.clear("namespace")}},{text:"Rename this namespace...",onclick:t}]:[{text:"Make this a namespace...",onclick:t}]:[]},tagContents:function(e){var n;return r(e)?(n=e.get("namespace"))?"Namespace: "+n:"Section":""},connectionRequest:function(e,n){var t,o;if("term"===n.typeName())return o=n.id(),M.call(function(){var n,o,r,i;for(r=e.connectionsOut(),i=[],n=0,o=r.length;o>n;n++)t=r[n],i.push(t[1]);return i}(),o)>=0?e.disconnect(n):p(n.id(),e.id())?alert("That would create a cycle of arrows, which is not permitted."):e.connect(n)}}),o=window.bodyGroupToCode=function(e){var n,t,r,i,a,c,s,u,f,d,h,m,p,g;if(t=function(){var t,o,r,i;for(r=e.children,i=[],t=0,o=r.length;o>t;t++)n=r[t],("term"===n.typeName()||"body"===n.typeName())&&i.push(n);return i}(),0===t.length)return""+e.contentAsText()+" -- "+e.id();for(p=t.slice(0,-1),i=u=0,h=p.length;h>u;i=++u)if(n=p[i],"body"===n.typeName())throw Error("A body group can only contain other body groups as its final child.  This one has another body group as child #"+(i+1)+".");for(r=tinymce.activeEditor.Groups,s=function(e){var t,o,i,a,c,u,l,f;for(u=e.connectionsIn(),o=0,a=u.length;a>o;o++)if(t=u[o],"body"===r[t[0]].typeName())throw Error("One of the groups inside this body has a body group connected to it.  That type of nesting is not permitted.");for(l=e.children,f=[],i=0,c=l.length;c>i;i++)n=l[i],f.push(s(n));return f},s(e),c=[],f=0,m=t.length;m>f;f++)if(n=t[f],"term"===n.typeName()){if(l(n))continue;c.push(w(n))}else c.push(o(n));for(i=d=0,g=c.length-1;g>=0?g>d:d>g;i=g>=0?++d:--d)a=/^(.*) -- (\d+)$/.exec(c[i]),c[i]="assume "+a[1]+", -- "+a[2];return c.join("\n")},y=window.sectionGroupToCode=function(e){var n,t,o,i,a,c,s,u,f,h;for(i=e.get("namespace"),s=i?"namespace":"section",c=null!=i?i:e.id(),o=("namespace"===s?"":s)+c,a=[],h=e.children,u=0,f=h.length;f>u;u++)if(n=h[u],!l(n))try{if("term"===n.typeName())a.push(w(n));else if("body"===n.typeName()){if(!r(n))continue;a.push(y(n))}}catch(m){t=m,d(n,!1,t.message)}return""+s+" "+o+" -- "+e.id()+"\n "+a.join("\n")+"\n end "+o+" -- "+e.id()},window.afterEditorReady=function(e){return e.on("KeyUp",function(n){var t,o,r,i,a,c,s,u,l,f,d,h,m;if(c=[33,34,35,36,37,38,39,40],a=[16,17,18,91],h=n.keyCode,!(M.call(c,h)>=0||(m=n.keyCode,M.call(a,m)>=0))&&(u=e.selection.getRng(),u.startContainer===u.endContainer&&u.startContainer instanceof e.getWin().Text)){if(r=u.startContainer.textContent,i=r[u.startOffset-1]," "!==i&&"\\"!==i&&i!==String.fromCharCode(160))return;if(o=r.substr(0,u.startOffset-1),t=r.substring(u.startOffset-1),f=o.lastIndexOf("\\"),-1===f)return;if(d=o.substr(f+1),o=o.substr(0,f),!(l=corrections[d]))return;return s=u.startOffset-d.length-1+l.length,"\\"!==i&&(t=t.substr(1),s--),u.startContainer.textContent=o+l+t,u.setStart(u.startContainer,s),u.setEnd(u.startContainer,s),e.selection.setRng(u)}})}}).call(this);
//# sourceMappingURL=lean-example-solo.min.js.map
(function(){var e,n,t,r,o,a,l,i,s,u,c,f,d,h={}.hasOwnProperty,p=[].indexOf||function(e){for(var n=0,t=this.length;t>n;n++)if(n in this&&this[n]===e)return n;return-1},v=[].slice;c=function(e,n){var t,r;return t=JSON.parse(null!=(r=window.localStorage.testData)?r:"{}"),t[e]=n,window.localStorage.testData=JSON.stringify(t)},f=function(){var e,n;return e=JSON.parse(null!=(n=window.localStorage.testData)?n:"{}"),Object.keys(e).sort()},o=function(e){var n,t;return n=JSON.parse(null!=(t=window.localStorage.testData)?t:"{}"),n[e]},s=function(e){var n,t;return n=JSON.parse(null!=(t=window.localStorage.testData)?t:"{}"),delete n[e],window.localStorage.testData=JSON.stringify(n)},l=null,i=function(){return(new Date).getTime()},d=function(){return l=i()},n=function(){return"(took "+(i()-l)+" ms)"},e=window.Module={},e.TOTAL_MEMORY=67108864,e.noExitRuntime=!0,a=null,r=null,e.print=function(e){var n;if(n=null,n=/FLYCHECK_BEGIN (.*)/.exec(e))return a={type:n[1],text:[]};if(a)return(n=/([^:]+):(\d+):(\d+): (.*)/.exec(e))?(a.file=n[1],a.line=n[2],a["char"]=n[3],a.info=n[4]):/FLYCHECK_END/.test(e)?(r.push(a),a=null):a.text.push(e);throw new Error("Unexpected output from Lean: "+e)},e.preRun=[function(){return d()}],u=window.runLeanOn=function(n){return d(),e.lean_init(),d(),FS.writeFile("test.lean",n,{encoding:"utf8"}),d(),r=[],e.lean_process_file("test.lean"),r},$(function(){var e,n,r,a,l,i,d,v;return $('[data-toggle="tooltip"]').tooltip(),n=null,r=null,a=null,l=null,v=function(){var e;return e=$(".output-tabs > li.active > a").get(0),parseInt(e.getAttribute("id").slice(-1))},e=function(e){var n;return $(".output-tabs > li").removeClass("active"),n=$(".output-tabs > li > a#tab"+e).get(0),$(n.parentNode).addClass("active"),d()},d=function(){return $("#output").val(function(){switch(v()){case 1:return r;case 2:return a;case 3:return l}}())},$(".output-tabs > li > a").click(function(e){return $(".output-tabs > li").removeClass("active"),$(this.parentNode).addClass("active"),d()}),setInterval(function(){var e;return e=$("#input").val(),e!==n?(n=e,$("#output").val("...RUNNING..."),setTimeout(function(){var e,o,i,s,c,f,p,v,g,m,b,y,k,L,w;try{e=t(n),r=e.code()}catch(E){i=E,r="Error in compilation!\n"+i.stack}try{f=u(r),a=JSON.stringify(f,null,4)}catch(E){i=E,f=null,a="Error in Lean run!\n"+i.stack}try{if(null===f)throw Error("Previous step encountered an error... Check earlier tabs for details.");for(m=0,y=f.length;y>m;m++)v=f[m],p=parseInt(null!=(L=v.line)?L:1),e.lineToElement(p).feedback=v;for(l="",w=e.elements,b=0,k=w.length;k>b;b++)if(s=w[b],s.lpfCode&&(l+=s.lpfCode,"\n"!==l.slice(-1)&&(l+="\n"),o=s.feedbackData())){l+="    "+o.result+"\n",o.reason&&(l+="    "+o.reason+"\n");for(c in o)h.call(o,c)&&(g=o[c],"result"!==c&&"reason"!==c&&(l+="    "+c+" = "+g+"\n"))}}catch(E){i=E,l="Error in translation!\n"+i.stack}return d()},0)):void 0},1e3),$("#loadButton").click(function(e){var n,t,r;return t=f(),0===t.length?alert("You have not saved any LPF arrays yet."):(r=prompt("Type the name of the LPF array to load, chosen from the following list:\n \n"+t.join("\n"),t[0]),null!=r?(n=o(r),n?$("#input").val(o(r)):alert('I could not load the LPF array "'+r+'."')):void 0)}),i=null,$("#saveButton").click(function(e){var n;return n=prompt("Type the name under which to save this LPF array.",i),null==n||p.call(f(),n)>=0&&!confirm("Save over LPF array of that same name?")?void 0:(c(n,$("#input").val()),i=n)}),$("#eraseButton").click(function(e){var n,t;return n=f(),0===n.length?alert("You have not saved any LPF arrays yet."):(t=prompt("Type the name of the LPF array to erase, chosen from the following list:\n \n"+n.join("\n"),n[0]),null==t||p.call(n,t)<0||!confirm("Are you SURE you want to ERASE "+t+"?")?void 0:s(t))}),$("#input").keydown(function(n){var t,r;if(r={1:2,2:3,3:1},t={1:3,2:1,3:2},n.altKey){if(219===n.keyCode)return e(t[v()]),n.preventDefault(),!1;if(221===n.keyCode)return e(r[v()]),n.preventDefault(),!1}}),$("#input").val("// \n// EXAMPLE CODE TO GET YOU STARTED \n// \nGlobal(SYMBOL,_true,[],Prop,[]) \nGlobal(SYMBOL,_false,[],Prop,[]) \nGlobal(SYMBOL,_or,[Prop,Prop],Prop,[]) \nGlobal(RULE,_true_intro,[],_true,[]) \nGlobal(RULE,_or_intro_left,[A:Prop,B:Prop,B],_or A B,[A,B]) \nGlobal(RULE,_or_intro_right,[A:Prop,B:Prop,A],_or A B,[A,B]) \nBegin() \nLocal(X,Prop,[]) \nStep(_true,[],_true_intro,[]) \nStep(_or X _true,[X],_or_intro_left,[8]) \nEnd()"),$("#input").focus()}),t=function(e){var n,t,r,o,a,l,i,s,u,c,f,d,h,g,m,b,y,k,L,w,E,_,S,$,P,C,x,O,A,B,T,D,I,N,j,R,Y,F,G,U,M,J,V,X,K,z,H,Z,q,Q,W,ee,ne,te;for(j={},r=/^\/\/(.*)(\n|$)/,J=/^\s+/,b=/^Global\s*\(\s*(SYMBOL|RULE)\s*,\s*(\w+)\s*,\s*\[([^\]]*)\]\s*,\s*([^,]+)\s*,\s*\[([^\]]*)\]\s*\)/,R=/^Step\s*\(\s*([^,]+)\s*,\s*\[([^\]]*)\]\s*,\s*(\w+)\s*,\s*\[((\s|\d|,)*)\]\s*\)/,G=/^Type\s*\(\s*(\w+)\s*\)/,t=/^Begin\s*\(\s*\)/,s=/^End\s*\(\s*\)/,$=/^Local\s*\(\s*(\w+)\s*,\s*(\w+)\s*,\s*\[([^\]]*)\]\s*\)/,j=[],S={},h={},c=[],_=null,a=0,O=e,T=null,P=null,j.elements=[{lpfCode:"",lpfPosition:-1,leanCode:"notation `Prop` := Type.{0}",numLines:1}],f=function(){return null==this.feedback?null:(console.log(this.feedback),"information:check result:"===this.feedback.info?{result:"VALID"}:"error: type mismatch at application"===this.feedback.info?{result:"INVALID",reason:"bad premise",premiseIndex:parseInt(this.feedback.text[2].trim().slice(5))+1,correctType:this.feedback.text[4].trim(),assertedType:this.feedback.text[6].trim()}:(P=/error: unknown identifier '([^']+)'/.exec(this.feedback.info))?{result:"INVALID",reason:"undeclared identifier",identifier:P[1]}:"error: type mismatch at term"===this.feedback.info?{result:"INVALID",reason:"bad conclusion",correctType:this.feedback.text[2].trim(),assertedType:this.feedback.text[4].trim()}:{result:"INVALID",reason:this.feedback.info,warning:"Unknown error type -- could not translate"})},j.lineToElement=function(e){var n,t,r,o,a;for(t=0,a=this.elements,r=0,o=a.length;o>r;r++)if(n=a[r],t+=n.numLines,t>=e)return n;return null},j.code=function(){var e;return function(){var n,t,r,o;for(r=this.elements,o=[],n=0,t=r.length;t>n;n++)e=r[n],o.push(e.leanCode);return o}.call(this).join("\n")},j.add=function(e){return this.elements.push({lpfCode:P[0],lpfPosition:T,leanCode:e,numLines:e.split("\n").length,feedbackData:f})},i=function(e){return e.replace(/\./g,",")};e.length>0;){if(T=O.length-e.length,P=r.exec(e))j.add("-- "+P[1]);else if(P=J.exec(e));else if(P=b.exec(e))F=P[1],C=""+P[2],w=P[3],w=/^\s*$/.test(w)?[]:function(){var e,n,t,r;for(t=w.split(","),r=[],e=0,n=t.length;n>e;e++)y=t[e],r.push(y.trim());return r}(),A=P[4],g=P[5],g=/^\s*$/.test(g)?[]:function(){var e,n,t,r;for(t=g.split(","),r=[],e=0,n=t.length;n>e;e++)Y=t[e],r.push(Y.trim());return r}(),w=function(){var e,n,t;for(t=[],L=e=0,n=w.length;n>e;L=++e)u=w[L],t.push(/^\s*[a-zA-Z_][a-zA-Z_0-9]*\s*:/.test(u)?v.call(function(){var e,n,t,r;for(t=u.split(":"),r=[],e=0,n=t.length;n>e;e++)Y=t[e],r.push(Y.trim());return r}()).concat(["pair"]):["dummy"+L,u,"singleton"]);return t}(),"SYMBOL"===F&&0===w.length?j.add("constant "+C+" : "+i(A)):"SYMBOL"===F?(k=function(){var e,n,t;for(t=[],e=0,n=w.length;n>e;e++)M=w[e],t.push(M[0]);return t}(),w=function(){var e,n,t;for(t=[],e=0,n=w.length;n>e;e++)M=w[e],t.push("("+M[0]+" : "+i(M[1])+")");return t}(),j.add("inductive "+C+" "+w.join(" ")+" : "+A+" := mk : "+k.join(" -> ")+" -> "+C+" "+k.join(" "))):"RULE"===F?(w=function(){var e,n,t;for(t=[],e=0,n=w.length;n>e;e++)M=w[e],t.push("pair"===M[2]?"{"+M[0]+" : "+i(M[1])+"}":"("+M[0]+" : "+i(M[1])+")");return t}(),j.add("constant "+C+" "+w.join(" ")+" : "+i(A))):j.add("-- Invalid Global type: "+F),a++;else if(P=R.exec(e)){if(o=i(P[1]),g=P[2],g=/^\s*$/.test(g)?[]:function(){var e,n,t,r;for(t=g.split(","),r=[],e=0,n=t.length;n>e;e++)Y=t[e],r.push(Y.trim());return r}(),N=""+P[3],I=P[4],n=g.slice(0),/^\s*$/.test(I))I=[];else{for(I=function(){var e,n,t,r;for(t=I.split(","),r=[],e=0,n=t.length;n>e;e++)y=t[e],r.push(parseInt(y.trim()));return r}(),V=0,H=I.length;H>V;V++)for(y=I[V],te=null!=(ne=h[y])?ne:[],X=0,Z=te.length;Z>X;X++)d=te[X],p.call(n,d)<0&&n.push(d);I=function(){var e,n,t;for(t=[],e=0,n=I.length;n>e;e++)y=I[e],t.push("("+S[y]+")");return t}()}if(l="",m=function(e){var n,t,r,o;for(y=c.length-1;y>=0;){for(o=c[y],t=0,r=o.length;r>t;t++)if(n=o[t],n[0]===e)return n[1];y--}return _},n.length>0){for(U=[],K=0,q=n.length;q>K;K++)M=n[K],m(M)||U.push(M);if(U.length>0){j.add("-- Undeclared variable(s): "+U.join(", "));break}n=function(){var e,t,r;for(r=[],e=0,t=n.length;t>e;e++)M=n[e],r.push("("+M+" : "+i(m(M))+")");return r}(),l=n.join(" ")}if(I.length>0)for(L=z=0,Q=I.length;Q>z;L=++z)D=I[L],l+=" (dummy"+L+" : "+D+")",I[L]="dummy"+L;l=l.length>0?"variables "+l:"-- no variable declarations needed",j.add("section \n  "+l+" \n  check (("+N+" "+I.join(" ")+") : "+o+") \nend"),S[a]=o,h[a]=g.slice(0),a++}else if(P=G.exec(e))j.add("-- Type "+i(P[1])),_=i(P[1]),a++;else if(P=t.exec(e))j.add("-- Begin"),c.push([]),a++;else if(P=s.exec(e)){if(j.add("-- End"),0===c.length){j.add("-- Cannot do End here!");break}if(null==(o=S[a-1])){j.add("-- Subproof had no conclusion!");break}I=function(){var e,n,t,r;for(t=c.pop(),r=[],n=0,e=t.length;e>n;n++)B=t[n],r.push("("+B[0]+" : "+B[1]+")");return r}(),S[a]="Pi "+I.join(" ")+", ("+o+")",a++}else{if(!(P=$.exec(e))){j.add("-- Cannot understand: "+e);break}if(j.add("-- Local "+P[1]+" "+P[2]+" "+P[3]),0===c.length){j.add("-- Cannot do Local here!");break}for(E=c[c.length-1],x=!0,ee=0,W=E.length;W>ee;ee++)if(B=E[ee],B[0]===P[1]){j.add("-- Cannot redeclare "+P[1]+" here!"),x=!1;break}x&&E.push([P[1],i(P[2])]),S[a]=i(P[2]),a++}e=e.slice(P[0].length)}return console.log(S),j}}).call(this);
//# sourceMappingURL=lpf-test.solo.min.js.map
(function(){var e,t=[].indexOf||function(e){for(var t=0,i=this.length;i>t;t++)if(t in this&&this[t]===e)return t;return-1};setAppName("Lurch"),window.menuBarIcon={src:"icons/apple-touch-icon-76x76.png",width:"26px",height:"26px",padding:"2px"},window.groupTypes=[{name:"me",text:"Meaningful expression",imageHTML:'<font color="#996666">[ ]</font>',openImageHTML:'<font color="#996666">[</font>',closeImageHTML:'<font color="#996666">]</font>',tooltip:"Make text a meaningful expression",color:"#996666",connectionRequest:function(e,i){var n,o,a,r;for(o=function(){var t,o,a,r;for(a=e.connectionsOut(),r=[],t=0,o=a.length;o>t;t++)n=a[t],n[1]===i.id()&&r.push(""+n[2]);return r}(),a=0;r=""+a,t.call(o,r)>=0;)a++;return e.connect(i,""+a)}}],window.useGroupConnectionsUI=!0,window.pluginsToLoad=["mediawiki","settings","dialogs"],window.groupMenuItems={file_order:"dropboxopen dropboxsave | sharelink wikiimport wikiexport | appsettings docsettings",dropboxopen:{text:"Open from Dropbox...",context:"file",onclick:function(){return tinymce.activeEditor.LoadSave.handleOpen(function(){return Dropbox.choose({success:function(e){return $.ajax({url:e[0].link,success:function(t){var i,n,o;return o=extractMetadata(t),n=o.metadata,i=o.document,tinymce.activeEditor.setContent(i),null!=n&&tinymce.activeEditor.LoadSave.loadMetaData(n),tinymce.activeEditor.LoadSave.setFilename(e[0].name)},error:function(e,t,i){return tinymce.activeEditor.Dialogs.alert({title:"File load error",message:"<h1>Error loading file</h1> <p>The file failed to load from the URL Dropbox provided, with an error of type "+t+".</p>"})}})},linkType:"direct",multiselect:!1})})}},dropboxsave:{text:"Save to Dropbox...",context:"file",onclick:function(){var e,t,i;return e=embedMetadata(tinymce.activeEditor.getContent(),tinymce.activeEditor.LoadSave.saveMetaData()),i="data:text/html,"+encodeURIComponent(e),null==tinymce.activeEditor.LoadSave.filename&&(tinymce.activeEditor.LoadSave.setFilename(prompt("Choose a filename","My Lurch Document.html")),null==tinymce.activeEditor.LoadSave.filename)?void tinymce.activeEditor.Dialogs.alert({title:"Saving requires a filename",message:"You must specify a filename before you can save the file into your Dropbox."}):(t=tinymce.activeEditor.LoadSave.filename,Dropbox.save(i,t,{success:function(){return tinymce.activeEditor.Dialogs.alert({title:"File saved successfully.",message:"<h1>Saved successfully.</h1> <p>File saved to Dropbox:<br> "+t+"</p>"}),tinymce.activeEditor.LoadSave.setDocumentDirty(!1)},error:function(e){return tinymce.activeEditor.Dialogs.alert({title:"Error saving file",message:"<h1>File not saved!</h1> <p>File NOT saved to Dropbox:<br> "+t+"</p> <p>Reason: "+e+"</p>"})}}))}},sharelink:{text:"Share document...",context:"file",onclick:function(){var e,t,i,n,o,a,r;return e=window.location.href.split("?")[0],n=e+"?document="+encodeURIComponent(tinymce.activeEditor.getContent()),i=function(e){var t;return t=("<iframe src='"+e+"' width=800 height=600></iframe>").replace(/&/g,"&amp;").replace(/'/g,"&apos;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),console.log(t),tinymce.activeEditor.Dialogs.alert({title:"Permanent Sharing Links",message:"<h3>Sharing URL</h3> <p>Copy this URL to your clipboard, and paste wherever you like, such as email.</p> <input type='text' size=50 id='firstURL' value='"+e+"'/> <h3>Embedding HTML</h3> <p>Copy this HTML to your clipboard, and paste into any webpage or blog to embed a Lurch instance with this document in it.</p> <input type='text' size=50 value='"+t+"'/> <script> var all = document.getElementsByTagName( 'input' ); for ( var i = 0 ; i < all.length ; i++ ) { all[i].addEventListener( 'focus', function ( event ) { var t = event.target; if ( t.select ) t.select(); else t.setSelectionRange( 0, t.value.length ); } ); } document.getElementById( 'firstURL' ).focus(); </script>"})},t="undefined"!=typeof gapi&&null!==gapi&&null!=(o=gapi.client)&&null!=(a=o.urlshortener)&&null!=(r=a.url)&&"function"==typeof r.insert?r.insert({resource:{longUrl:n}}):void 0,null==t?i(n):t.execute(function(e){return i(null!=e.id?e.id:n)})}},wikiimport:{text:"Import from wiki...",context:"file",onclick:function(){var t;if(!e()&&(t=prompt("Give the name of the page to import (case sensitive)","Main Page"),null!==t))return tinymce.activeEditor.MediaWiki.importPage(t,function(e,t){return null!=t?tinymce.activeEditor.Settings.document.metadata=t:void 0})}},wikiexport:{text:"Export to wiki",context:"file",onclick:function(){var t,i,n,o,a;if(!e())return i=tinymce.activeEditor.Settings.document.get("wiki_title"),null==i?void tinymce.activeEditor.Dialogs.alert({title:"Page Title not set",message:"<p>You have not yet set the title under which this document should be published on the wiki.  See the document settings on the File menu.</p>"}):(a=tinymce.activeEditor.Settings.application.get("wiki_username"),n=tinymce.activeEditor.Settings.application.get("wiki_password"),null==a||null==n?void tinymce.activeEditor.Dialogs.alert({title:"No Wiki Credentials",message:"<p>You have not given your wiki username and password to the application settings.  See the application settings on the File menu.</p>"}):(o=function(e,t){var n,o;return t?void tinymce.activeEditor.Dialogs.alert({title:"Posting Error",message:"<p>Error when posting to the wiki:</p> <p>"+t+"</p>"}):(n=/^[^/]+\/\/[^/]+\//.exec(window.location.href),o=window.location.href.slice(0,n[0].length)+"wiki/index.php?title="+encodeURIComponent(i),tinymce.activeEditor.Dialogs.alert({title:"Document Posted",message:"<p>Posting succeeded.</p> <p><a href='"+o+"' target='_blank'>Visit posted page.</a></p>"}))},t=function(e,t){var n;return t?void tinymce.activeEditor.Dialogs.alert({title:"Wiki Login Error",message:"<p>Error when logging into the wiki:</p> <p>"+t+"</p>"}):(n=tinymce.activeEditor.MediaWiki.embedMetadata(tinymce.activeEditor.getContent(),tinymce.activeEditor.Settings.document.metadata),tinymce.activeEditor.MediaWiki.exportPage(i,n,o))},tinymce.activeEditor.MediaWiki.login(a,n,t)))}},appsettings:{text:"Application settings...",context:"file",onclick:function(){return tinymce.activeEditor.Settings.application.showUI()}},docsettings:{text:"Document settings...",context:"file",onclick:function(){return tinymce.activeEditor.Settings.document.showUI()}}},window.addEventListener("load",function(){var e,t;return"undefined"!=typeof gapi&&null!==gapi&&null!=(e=gapi.client)&&e.setApiKey("AIzaSyAf7F0I39DdI2jtD7zrPUa4eQvUXZ-K6W8"),"undefined"!=typeof gapi&&null!==gapi&&null!=(t=gapi.client)?t.load("urlshortener","v1",function(){}):void 0},!1),window.afterEditorReady=function(e){var t,i,n,o;return t=e.Settings.addCategory("application"),t.setup=function(i){var n,o;return i.innerHTML=[e.Settings.UI.heading("Wiki Login"),e.Settings.UI.info('Entering a username and password here does NOT create an account on the wiki.  You must already have one.  If you do not, first visit <a href="/wiki/index.php" target="_blank" style="color: blue;">the wiki</a>, create an account, then return here.'),e.Settings.UI.text("Username","wiki_username",null!=(n=t.get("wiki_username"))?n:""),e.Settings.UI.password("Password","wiki_password",null!=(o=t.get("wiki_password"))?o:"")].join("\n")},t.teardown=function(e){var i;return i=function(t){return e.ownerDocument.getElementById(t)},t.set("wiki_username",i("wiki_username").value),t.set("wiki_password",i("wiki_password").value)},i=e.Settings.addCategory("document"),i.metadata={},i.get=function(e){return i.metadata[e]},i.set=function(e,t){return i.metadata[e]=t},i.setup=function(t){var n;return t.innerHTML=[e.Settings.UI.heading("Dependencies"),"<div id='dependenciesSection'></div>",e.Settings.UI.heading("Wiki Publishing"),e.Settings.UI.text("Publish to wiki under this title","wiki_title",null!=(n=i.get("wiki_title"))?n:"")].join("\n"),e.Dependencies.installUI(t.ownerDocument.getElementById("dependenciesSection"))},i.teardown=function(e){var t;return t=function(t){return e.ownerDocument.getElementById(t)},i.set("wiki_title",t("wiki_title").value)},e.LoadSave.saveMetaData=function(){return i.metadata.dependencies=e.Dependencies["export"](),i.metadata},e.LoadSave.loadMetaData=function(t){var n;return i.metadata=t,e.Dependencies["import"](null!=(n=i.metadata.dependencies)?n:[])},e.MediaWiki.setIndexPage("/wiki/index.php"),e.MediaWiki.setAPIPage("/wiki/api.php"),(n=/\?wikipage=(.*)/.exec(window.location.search))&&e.MediaWiki.importPage(decodeURIComponent(n[1],function(t,i){return null!=i?e.LoadSave.loadMetaData(i):void 0})),(o=localStorage.getItem("auto-load"))&&setTimeout(function(){return localStorage.removeItem("auto-load"),tinymce.activeEditor.setContent(o)},100),(n=/\?document=(.*)/.exec(window.location.search))?(localStorage.setItem("auto-load",decodeURIComponent(n[1])),window.location.href=window.location.href.split("?")[0]):void 0},e=function(){var e;return e=/nathancarter\.github\.io/.test(window.location.href),e&&tinymce.activeEditor.Dialogs.alert({title:"Not Available Here",message:"<p>That functionality requires MediaWiki to be running on the server from which you're accessing this web app.</p> <p>On GitHub, we cannot run a MediaWiki server, so the functionality is disabled.</p> <p>The menu items remain for use in developer testing, as we prepare for a dedicated server that will have MediaWiki and the ability to publish documents to that wiki with a single click, or edit them in Lurch with a single click.</p> <p>Try back soon!</p>"}),e}}).call(this);
//# sourceMappingURL=main-app-solo.min.js.map
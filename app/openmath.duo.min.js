(function(){var e,t,n,r=function(e,t){return function(){return e.apply(t,arguments)}},i={}.hasOwnProperty,a=[].slice,f=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};("undefined"==typeof t||null===t)&&(t=null!=(n="undefined"!=typeof module&&null!==module?module.exports:void 0)?n:window),t.OMNode=e=function(){function e(e){this.tree=e,this.encode=r(this.encode,this)}return e.checkJSON=function(e){var t,n,r,s,u,o,c,l,y,h,p,v,d,b,g,m,N,O,k;if(!(e instanceof Object))return"Expected an object, found "+typeof e;if(e.hasOwnProperty("a")){m=e.a;for(u in m)if(i.call(m,u)){l=m[u];try{c=JSON.parse(u)}catch(J){return r=J,"Key "+u+" invalid JSON"}if("sy"!==c.t)return"Key "+u+" is not a symbol";if(o=this.checkJSON(c))return o;if(o=this.checkJSON(l))return o}}switch(t=function(){var t,n,r,i;for(t=1<=arguments.length?a.call(arguments,0):[],i=Object.keys(e),n=0,r=i.length;r>n;n++)if(u=i[n],f.call(t,u)<0&&"t"!==u&&"a"!==u)return"Key "+u+" not valid in object of type "+e.t;return null},s=/^[:A-Za-z_][:A-Za-z_.0-9-]*$/,e.t){case"i":if(o=t("v"))return o;if(!/^[+-]?[0-9]+$/.test(""+e.v))return"Not an integer: "+e.v;break;case"f":if(o=t("v"))return o;if("number"!=typeof e.v)return"Not a number: "+e.v+" of type "+typeof e.v;if(isNaN(e.v))return"OpenMath floats cannot be NaN";if(!isFinite(e.v))return"OpenMath floats must be finite";break;case"st":if(o=t("v"))return o;if("string"!=typeof e.v)return"Value for st type was "+typeof e.v+", not string";break;case"ba":if(o=t("v"))return o;if(!(e.v instanceof Uint8Array))return"Value for ba type was not an instance of Uint8Array";break;case"sy":if(o=t("n","cd","uri"))return o;if("string"!=typeof e.n)return"Name for sy type was "+typeof e.n+", not string";if("string"!=typeof e.cd)return"CD for sy type was "+typeof e.cd+", not string";if(null!=e.uri&&"string"!=typeof e.uri)return"URI for sy type was "+typeof e.uri+", not string";if(!s.test(e.n))return"Invalid identifier as symbol name: "+e.n;if(!s.test(e.cd))return"Invalid identifier as symbol CD: "+e.cd;break;case"v":if(o=t("n"))return o;if("string"!=typeof e.n)return"Name for v type was "+typeof e.n+", not string";if(!s.test(e.n))return"Invalid identifier as variable name: "+e.n;break;case"a":if(o=t("c"))return o;if(!(e.c instanceof Array))return"Children of application object was not an array";if(0===e.c.length)return"Application object must have at least one child";for(N=e.c,h=0,d=N.length;d>h;h++)if(n=N[h],o=this.checkJSON(n))return o;break;case"bi":if(o=t("s","v","b"))return o;if(o=this.checkJSON(e.s))return o;if("sy"!==e.s.t)return"Head of a binding must be a symbol";if(!(e.v instanceof Array))return"In a binding, the v value must be an array";for(O=e.v,p=0,b=O.length;b>p;p++){if(y=O[p],o=this.checkJSON(y))return o;if("v"!==y.t)return"In a binding, all values in the v array must have type v"}if(o=this.checkJSON(e.b))return o;break;case"e":if(o=t("s","c"))return o;if(o=this.checkJSON(e.s))return o;if("sy"!==e.s.t)return"Head of an error must be a symbol";if(!(e.c instanceof Array))return"In an error, the c key must be an array";for(k=e.c,v=0,g=k.length;g>v;v++)if(n=k[v],o=this.checkJSON(n))return o;break;default:return"Invalid type: "+e.t}return null},e.decode=function(t){var n,r,a,f;try{r=JSON.parse(t)}catch(s){return n=s,n.message}return(a=this.checkJSON(r))?a:(f=function(e){var t,n,r,a,s,u,o,c,l,y,h,p,v;for(l=null!=(c=e.c)?c:[],a=0,u=l.length;u>a;a++)t=l[a],t.p=e,f(t);for(h=null!=(y=e.v)?y:[],s=0,o=h.length;o>s;s++)r=h[s],r.p=e,f(r);v=null!=(p=e.a)?p:{};for(n in v)i.call(v,n)&&(r=v[n],r.p=e,f(r));return null!=e.s&&(e.s.p=e,f(e.s)),null!=e.b?(e.b.p=e,f(e.b)):void 0},f(r),r.p=null,new e(r))},e.prototype.encode=function(){return JSON.stringify(this.tree,function(e,t){return"p"===e?void 0:t})},e}()}).call(this);
//# sourceMappingURL=openmath.duo.min.js.map
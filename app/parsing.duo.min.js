(function(){var e,t,n,s,r,o,i,l,u,h=function(e,t){return function(){return e.apply(t,arguments)}},a=[].slice;("undefined"==typeof i||null===i)&&(i=null!=(u="undefined"!=typeof module&&null!==module?module.exports:void 0)?u:window),"undefined"!=typeof require&&null!==require&&require("./utils"),l=function(e){return e.pos<e.rhs.length?e.rhs[e.pos]:null},n=function(e){return{lhs:e.lhs,rhs:e.rhs,pos:e.pos,ori:e.ori,got:e.got.slice(0)}},o=function(e,t){var n,s,r,o,i;if(e.length!==t.length)return!1;for(r=o=0,i=e.length;i>o;r=++o)if(n=e[r],s=t[r],n instanceof RegExp){if(!(s instanceof RegExp)||n.source!==s.source)return!1}else if(n!==s)return!1;return!0},i.Grammar=e=function(){function e(e){this.START=e,this.parse=h(this.parse,this),this.addRule=h(this.addRule,this),this.setOption=h(this.setOption,this),this.rules={},this.defaults={addCategories:!0,collapseBranches:!1,showDebuggingOutput:!1,expressionBuilder:null,tokenizer:null,comparator:JSON.equals}}return e.prototype.setOption=function(e,t){return this.defaults[e]=t},e.prototype.addRule=function(){var e,t,n,s,r,o,i,l,u,h,p;for(e=arguments[0],r=2<=arguments.length?a.call(arguments,1):[],p=[],i=0,u=r.length;u>i;i++){for(s=r[i],s instanceof RegExp&&(s=[s]),s instanceof Array||(s=(""+s).split(" ")),n=l=0,h=s.length;h>l;n=++l)t=s[n],t instanceof RegExp&&(s[n]=new RegExp("^"+t.source+"$"));p.push((null!=(o=this.rules)[e]?o[e]:o[e]=[]).push(s))}return p},e.prototype.parse=function(e,t){var s,i,u,h,a,p,f,g,c,d,m,x,y,k,w,B,R,v,z,O,T,b,E,A,C,D,q,S,G,j,F,J,N,P,U,$,H,I,K,L,M,Q,V,W;for(null==t&&(t={}),null==t.addCategories&&(t.addCategories=this.defaults.addCategories),null==t.collapseBranches&&(t.collapseBranches=this.defaults.collapseBranches),null==t.showDebuggingOutput&&(t.showDebuggingOutput=this.defaults.showDebuggingOutput),null==t.expressionBuilder&&(t.expressionBuilder=this.defaults.expressionBuilder),u={},null==t.tokenizer&&(t.tokenizer=this.defaults.tokenizer),null==t.comparator&&(t.comparator=this.defaults.comparator),i=t.showDebuggingOutput?console.log:function(){},i("\n\n"),null!=t.tokenizer&&"string"==typeof e&&(e=t.tokenizer.tokenize(e)),z=function(){var t,n,s;for(s=[],p=t=0,n=e.length;n>=0?n>=t:t>=n;p=n>=0?++t:--t)s.push([]);return s}(),z[0].push({lhs:"",rhs:[this.START],pos:0,ori:0,got:[]}),p=E=0,q=z.length;q>E;p=++E){for(O=z[p],i("processing stateSet "+p+" in this stateGrid (with input "+e+"):"),i("----------------------"),T=A=0,K=z.length;K>=0?K>A:A>K;T=K>=0?++A:--A){for(i("|    state set "+T+":"),R=0,b=C=0,L=z[T].length;L>=0?L>C:C>L;b=L>=0?++C:--C)z[T].length<15||z[T][b].pos>0?i("|        entry "+b+": "+r(z[T][b])):R++;R>0&&i("|    (plus "+R+" at pos 0 not shown)")}for(i("----------------------"),f=0;f<O.length;)if(v=O[f],i("entry "+f+":",r(v)),c=l(v),i("next:",c),null!==c)if(p>=e.length)f++;else if(i("is it a terminal?",c instanceof RegExp),c instanceof RegExp)c.test(e[p])&&(s=n(v),s.pos++,s.got.push(e[p]),z[p+1].push(s),i("scanner added this to "+(p+1)+":",r(s))),f++;else{if(!this.rules.hasOwnProperty(c))throw"Unknown non-terminal in grammar rule: "+c;for(w=this.rules[c],i("rhss: ["+w.join("],[")+"]"),g=N=0,G=w.length;G>N;g=++N){for(k=w[g],h=!1,P=0,j=O.length;j>P;P++)if(B=O[P],B.lhs===c&&o(B.rhs,k)&&0===B.pos){h=!0;break}h||(O.push({lhs:c,rhs:k,pos:0,ori:p,got:[]}),i("adding this state:",r(O[O.length-1])))}f++}else{for(i("considering if this completion matters to state set",v.ori),M=z[v.ori],g=D=0,S=M.length;S>D;g=++D)B=M[g],l(B)===v.lhs&&(B=n(B),B.pos++,a=v.got.slice(0),t.addCategories&&a.unshift(v.lhs),null!=t.expressionBuilder&&a.unshift(u),t.collapseBranches&&1===a.length&&(a=a[0]),B.got.push(a),z[p].push(B),i("completer added this to "+p+":",r(B)));f++}}for(i("finished processing this stateGrid (with input "+e+"):"),i("----------------------"),T=U=0,Q=z.length;Q>=0?Q>U:U>Q;T=Q>=0?++U:--U){for(i("|    state set "+T+":"),R=0,b=$=0,V=z[T].length;V>=0?V>$:$>V;b=V>=0?++$:--$)z[T].length<15||z[T][b].pos>0?i("|        entry "+b+": "+r(z[T][b])):R++;R>0&&i("|    (plus "+R+" at pos 0 not shown)")}for(i("----------------------"),y=[],W=z[z.length-1],H=0,F=W.length;F>H;H++)if(O=W[H],""===O.lhs&&null===l(O)){if(x=O.got[0],null!=t.expressionBuilder&&(m=function(e){var n,s;return e instanceof Array&&e[0]===u?(n=function(){var t,n,r,o;for(r=e.slice(1),o=[],n=0,t=r.length;t>n;n++)s=r[n],o.push(m(s));return o}(),1===n.length&&t.collapseBranches&&(n=n[0]),n.indexOf(void 0)>-1?void 0:t.expressionBuilder(n)):e},x=m(x),null==x))continue;for(h=!1,I=0,J=y.length;J>I;I++)if(d=y[I],t.comparator(d,x)){h=!0;break}h||y.push(x)}return y},e}(),i.Tokenizer=t=function(){function e(){this.tokenize=h(this.tokenize,this),this.addType=h(this.addType,this),this.tokenTypes=[]}return e.prototype.addType=function(e,t){return null==t&&(t=function(e){return e}),"^"!==e.source[0]&&(e=new RegExp("^(?:"+e.source+")")),this.tokenTypes.push({regexp:e,formatter:t})},e.prototype.tokenize=function(e){var t,n,s,r,o,i,l,u,h,a;for(o=[];e.length>0;){for(r=e.length,a=this.tokenTypes,u=0,h=a.length;h>u;u++)if(l=a[u],n=l.regexp.exec(e)){if(e=e.slice(n[0].length),l.formatter instanceof Function)s=l.formatter(n[0],n),null!=s&&o.push(s);else{for(t=""+l.formatter,i="";s=/\%([0-9]+)/.exec(t);)i+=t.slice(0,s.index)+n[s[1]],t=t.slice(s.index+s[0].length);o.push(i+t)}break}if(e.length===r)return null}return o},e}(),s=function(e){return e instanceof Array?"["+e.map(s).join(",")+"]":e},r=function(e){return"("+e.lhs+" -> "+e.pos+"in["+e.rhs+"], "+e.ori+") got "+s(e.got)}}).call(this);
//# sourceMappingURL=parsing.duo.min.js.map